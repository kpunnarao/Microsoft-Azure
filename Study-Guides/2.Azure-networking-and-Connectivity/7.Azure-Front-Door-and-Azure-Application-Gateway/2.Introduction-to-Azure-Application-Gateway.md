# Introduction to Azure Application Gateway (Web Application Firewall - WAF):

Azure Application Gateway is a **web traffic load balancer** that enables you to manage traffic to your web applications. 

It operates at **Layer 7 (HTTP/HTTPS)**, making it ideal for web-specific traffic management, and includes an optional but powerful **Web Application Firewall (WAF)** for security.

---

## What is Azure Application Gateway? üåê

Unlike Azure Load Balancer (which works at Layer 4) or Azure Traffic Manager (which works at the DNS level for global routing), Application Gateway focuses on **application-layer (HTTP/HTTPS) routing within a single Azure region**. 

It's designed specifically for web applications, offering features that go beyond simple load balancing.

Key capabilities of Application Gateway include:

* **URL-based Routing (Path-based routing)**: Directs traffic to different backend servers based on the URL path in the request (e.g., `www.contoso.com/images` goes to one server pool, `www.contoso.com/video` to another).
* **Multi-site Hosting**: Hosts more than one web application on the same Application Gateway instance, using host headers to direct traffic to the correct backend pool.
* **SSL Termination (SSL Offload)**: Decrypts SSL/TLS traffic at the gateway and sends unencrypted traffic to the backend servers, offloading the CPU-intensive encryption/decryption process from your web servers. It can also re-encrypt traffic to the backend for end-to-end encryption.
* **Session Affinity (Cookie-based affinity)**: Ensures that requests from a specific user are always directed to the same backend server for the duration of their session, which is crucial for stateful applications.
* **Web Application Firewall (WAF)**: An optional feature that provides centralized protection of your web applications from common web vulnerabilities and exploits. This is a core strength of Application Gateway.
* **WebSocket and HTTP/2 Support**: Handles modern web protocols.
* **Custom Error Pages**: Allows you to provide custom error pages for your users.
* **Zone Redundancy**: Can be deployed across Azure Availability Zones for higher resilience.
* **Autoscaling**: Automatically scales out or in based on traffic load.

---

## Web Application Firewall (WAF) Integration üõ°Ô∏è

The **Web Application Firewall (WAF)** is a key component of Azure Application Gateway, especially valuable for protecting public-facing web applications. When enabled, WAF inspects incoming web traffic to detect and block common web-based attacks.

### How WAF Works with Application Gateway:

1.  **Request Interception**: All incoming HTTP/HTTPS requests first pass through the Application Gateway, which then passes them to the WAF engine.
2.  **Rule-Based Inspection**: The WAF engine uses a set of rules, primarily based on the **OWASP (Open Web Application Security Project) Core Rule Set (CRS)**, to evaluate the request. These rules are designed to protect against common attacks like:
    * **SQL injection**: Prevents malicious SQL code from being inserted into input fields.
    * **Cross-site scripting (XSS)**: Blocks attempts to inject client-side scripts into web pages.
    * **HTTP protocol violations and anomalies**: Detects non-compliant requests.
    * **Common Attack Categories**: Including command injection, HTTP request smuggling, remote file inclusion, and more.
3.  **Managed Rule Sets**: Azure provides managed rule sets that are automatically updated by Microsoft, offering protection against emerging threats. You can also create **custom WAF rules** to address specific application vulnerabilities or block certain IP addresses.
4.  **Action on Detection**: Based on the WAF policy, detected threats can trigger different actions:
    * **Detection mode**: Logs the threat but allows the request to pass. Useful for testing and monitoring.
    * **Prevention mode**: Blocks the request and can return a custom error page or redirect. Logs the blocked request.
5.  **Centralized Protection**: WAF on Application Gateway offers centralized protection, meaning you don't need to configure WAF rules on each individual web server, simplifying management and ensuring consistent security policies.

### Benefits of WAF with Application Gateway:

* **Enhanced Security**: Protects against a wide range of common web vulnerabilities.
* **Simplified Compliance**: Helps meet compliance requirements by providing a security layer against known attack vectors.
* **Reduced Backend Load**: Blocks malicious traffic at the edge, reducing the burden on your backend web servers.
* **Centralized Management**: Manage security policies for multiple web applications from a single point.
* **Managed Rules**: Automatic updates by Microsoft ensure protection against new threats.

In summary, Azure Application Gateway is your go-to solution for **Layer 7 load balancing and advanced web traffic management within a single Azure region**, with its integrated WAF providing essential security for your web applications.