# Azure SQL Database: Backup and Restore Options:

Backup and restore are fundamental for any production database, ensuring data durability, business continuity, and disaster recovery. One of the significant advantages of Azure SQL Database as a PaaS offering is that **backups are fully automated and managed by Microsoft**.

You don't need to write backup scripts, manage backup media, or schedule jobs. Azure handles it all.

Azure SQL Database leverages SQL Server's full, differential, and transaction log backups to provide robust recovery capabilities.

### 1. Automated Backups

Azure SQL Database automatically takes and manages backups for all databases. The frequency and retention vary slightly based on the service tier.

* **Types of Automated Backups**:
    * **Full Backups**: Taken weekly. These are comprehensive backups of your entire database.
    * **Differential Backups**: Taken every 12 to 24 hours. These capture only the changes made since the last full backup, making them smaller and faster.
    * **Transaction Log Backups**: Taken approximately every 5-10 minutes. These capture all transactions since the last log backup, enabling point-in-time recovery. The exact frequency depends on the database activity and compute size.

* **Backup Storage Redundancy**:
    * By default, backups are stored in **geo-redundant storage (GRS)**, meaning copies are replicated to a paired Azure region hundreds of miles away. This is crucial for disaster recovery in case of a regional outage.
    * You can change the backup storage redundancy to **Zone-redundant storage (ZRS)** or **Locally redundant storage (LRS)** if your compliance requirements or cost constraints dictate, but this will affect your geo-restore capabilities.

### 2. Retention Policies

Automated backups are retained for a specific period, which determines how far back you can restore your database.

* **Short-Term Retention (Point-in-Time Restore - PITR)**:
    * **Default**: 7 days for most service tiers (can be 1-7 days for Basic, 1-35 days for others).
    * **Configurable**: You can increase this up to **35 days** for most service tiers (except Basic). This allows you to restore your database to any specific point in time within this retention window.

* **Long-Term Retention (LTR)**:
    * For compliance or archival purposes, you can configure LTR policies to retain specific full backups for much longer periods, up to **10 years**.
    * You can set policies for weekly, monthly, or yearly backups to be copied to separate, cost-effective Azure Blob storage.
    * LTR backups are immutable (cannot be altered) within the retention period, providing strong data integrity.

### 3. Restore Options

Azure SQL Database offers several ways to restore your database from these automated backups. Restoring always creates a **new database**. You cannot overwrite an existing database directly.

* **Point-in-Time Restore (PITR)**:
    * **Purpose**: Recover from data corruption, accidental deletions, or human errors by restoring the database to a precise point in time (to the second) within the short-term retention period.
    * **Mechanism**: Azure uses the full, differential, and transaction log backups to reconstruct the database state at your specified timestamp.
    * **Destination**: The restored database is created on the *same logical server* as the original, or a different logical server in the *same region*.
    * **Deleted Database Restore**: If you accidentally delete a database, you can restore it to its state just before deletion, as long as it's within the short-term retention period of the original database.

* **Geo-Restore**:
    * **Purpose**: Recover from a regional disaster (e.g., if the entire Azure region where your database is located becomes unavailable).
    * **Mechanism**: This uses the geo-replicated automated backups (requires GRS backup storage redundancy) to restore the database to any other Azure region.
    * **Recovery Point Objective (RPO)**: Geo-restore typically has an RPO of up to 1 hour, meaning you might lose up to one hour of data, depending on when the last geo-replicated transaction log backup occurred.
    * **Recovery Time Objective (RTO)**: Recovery can take up to 12 hours, but often much faster for smaller databases.

* **Restore from Long-Term Retention (LTR) Backup**:
    * **Purpose**: Restore a database from a specific, older full backup stored as part of your LTR policy. Useful for historical data analysis, compliance audits, or restoring very old versions.
    * **Destination**: Can be restored to any server in any Azure region.

### 4. Database Copy (Not a Backup, but a "Restore-like" operation)

* You can create a copy of an existing database at its *current state*. This is useful for creating a test environment, developing a new version, or preparing for a major schema change. It's not a point-in-time restore, but a snapshot-based copy.

### 5. Export to BACPAC (Manual Backup for Archival/Migration)

* While Azure handles automated backups, you can manually export your database to a `.bacpac` file (a compressed file containing schema and data) to Azure Blob storage.
* **Use Cases**:
    * **Archiving**: Keeping a manual, long-term archive copy outside of Azure's automated retention.
    * **Migration**: Moving a database between Azure SQL Database, SQL Server on-premises, or SQL Server on Azure VMs.
    * **Development**: Creating a local copy of your database for offline development.
* **Important**: This is a point-in-time logical copy, not a continuous backup solution. You are responsible for managing the `.bacpac` file.

### 6. Cost Implications

* **Short-Term Retention (PITR)**: The cost of backup storage for PITR is typically included up to a certain percentage of your provisioned database storage. Beyond that, you are charged for consumed backup storage. The amount of backup storage consumed depends on your database's daily change rate and the configured retention period.
* **Long-Term Retention (LTR)**: LTR backups are stored in standard Azure Blob storage, and you are charged explicitly for the storage consumed, based on the redundancy option (LRS, ZRS, GRS) you choose for the LTR.

In summary, Azure SQL Database provides a robust, automated backup and restore system that covers most business continuity and disaster recovery scenarios without requiring manual intervention, significantly reducing administrative overhead.