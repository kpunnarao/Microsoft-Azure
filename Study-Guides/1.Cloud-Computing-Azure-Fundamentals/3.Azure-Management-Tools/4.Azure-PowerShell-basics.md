## Azure PowerShell Basics üíª

Azure PowerShell is a powerful, command-line shell and scripting language specifically designed to manage and automate Azure resources. 

It provides a set of cmdlets (pronounced "command-lets") that interact directly with the Azure Resource Manager API, allowing you to perform virtually any task you can do in the Azure portal, but with greater efficiency and automation capabilities.

-----

### What is Azure PowerShell?

Azure PowerShell is essentially a collection of modules that extend Windows PowerShell or PowerShell Core with Azure-specific commands. 

It leverages PowerShell's object-oriented nature, allowing you to work with Azure resources as objects, which simplifies filtering, sorting, and passing data between commands.

  * **Cmdlets**: The core of Azure PowerShell are its cmdlets, which follow a consistent "Verb-Noun" naming convention (e.g., `Get-AzResourceGroup`, `New-AzVM`, `Remove-AzStorageAccount`). This makes them highly discoverable and easier to learn.
  * **Object-Oriented**: Unlike the Azure CLI which often works with JSON output, Azure PowerShell cmdlets typically return .NET objects. This allows for powerful piping, filtering, and manipulation of data directly within PowerShell scripts.
  * **Cross-Platform**: While PowerShell originated on Windows, PowerShell Core (which Azure PowerShell runs on) is cross-platform, meaning you can use Azure PowerShell on Windows, macOS, and Linux.
  * **Automation**: Azure PowerShell is an excellent choice for scripting complex deployments, managing multiple resources, or setting up automated tasks.

-----

### When to Use Azure PowerShell

  * **Existing PowerShell Users**: If you're already familiar with PowerShell for Windows Server administration or other Microsoft technologies, Azure PowerShell will feel natural.
  * **Complex Scripting**: For intricate automation workflows that benefit from PowerShell's scripting language features (loops, conditionals, functions, error handling).
  * **Object-Based Data Manipulation**: When you need to process and manipulate Azure resource data as objects within your scripts.
  * **Hybrid Cloud Management**: If you manage both on-premises Windows environments and Azure, using PowerShell provides a consistent scripting experience across both.

-----

## Day 3 Lab: Azure PowerShell Basics üöÄ

This lab will guide you through installing, configuring, and executing basic commands using Azure PowerShell on different operating systems.

### Lab Scenario üè∞

You need to set up Azure PowerShell on your local machine to manage Azure resources programmatically. This lab will cover:

  * **Installing Azure PowerShell** on Windows, macOS, and Linux.
  * **Configuring** your Azure PowerShell for first use.
  * Executing some **basic cmdlets** to interact with your Azure subscription.

-----

### Part 1: Installing Azure PowerShell

The recommended way to install Azure PowerShell is via the PowerShell Gallery, using the `Install-Module` cmdlet. This method ensures you get the latest version and simplifies updates.

**Important Note**: Azure PowerShell requires **PowerShell 7.x.x or later** (PowerShell Core) or **Windows PowerShell 5.1**. For cross-platform compatibility and the latest features, it's highly recommended to use PowerShell 7 (available for Windows, macOS, and Linux).

#### 1.1 Install PowerShell 7 (if not already installed)

If you don't have PowerShell 7, follow the instructions for your OS:

  * **Windows**: [https://learn.microsoft.com/en-us/powershell/scripting/install/install-powershell-windows](https://www.google.com/search?q=https://learn.microsoft.com/en-us/powershell/scripting/install/install-powershell-windows) (Look for MSI package or Winget)
  * **macOS**: [https://learn.microsoft.com/en-us/powershell/scripting/install/install-powershell-macos](https://www.google.com/search?q=https://learn.microsoft.com/en-us/powershell/scripting/install/install-powershell-macos) (Use Homebrew: `brew install powershell`)
  * **Linux**: [https://learn.microsoft.com/en-us/powershell/scripting/install/install-powershell-linux](https://www.google.com/search?q=https://learn.microsoft.com/en-us/powershell/scripting/install/install-powershell-linux) (Follow instructions for your specific distribution using `apt`, `dnf`, `snap`, etc.)

After installation, open a **new PowerShell 7** terminal and type `pwsh --version` to verify.

#### 1.2 Install Azure PowerShell Module (`Az`)

Once PowerShell 7 is installed, you can install the `Az` module.

1.  **Open PowerShell as Administrator** (on Windows) or with `sudo pwsh` (on Linux/macOS, if required for global install).

2.  **Install the `Az` module**:

    ```powershell
    Install-Module -Name Az -Scope CurrentUser -Repository PSGallery -Force
    ```

      * `-Name Az`: Specifies the name of the module.

      * `-Scope CurrentUser`: Installs the module only for the current user. Remove this if you want to install for all users (requires administrator/root privileges).

      * `-Repository PSGallery`: Specifies the PowerShell Gallery as the source.

      * `-Force`: Overwrites any existing older versions and suppresses prompts.

      * **Note**: If you receive a warning about an untrusted repository, type `Y` to proceed. You might want to run `Set-PSRepository -Name PSGallery -InstallationPolicy Trusted` to avoid this warning in the future.

3.  **Verify Installation**:

      * After the installation completes, close and reopen your PowerShell terminal.
      * Type `Get-Module -Name Az -ListAvailable` and press Enter.
      * You should see output indicating the `Az` module and its version.

-----

### Part 2: Configuring and Logging In to Azure PowerShell

Just like with the CLI, you need to log in to your Azure account.

#### 2.1 Logging In üîë

1.  **Open your PowerShell terminal**.
2.  Type the following cmdlet and press Enter:
    ```powershell
    Connect-AzAccount
    ```
3.  **Browser-Based Authentication**:
      * This command will open your default web browser and navigate to a Microsoft login page.
      * Sign in with your Azure account credentials.
      * Once authentication is complete in the browser, your PowerShell terminal will display information about your default subscription and logged-in account.

#### 2.2 Verifying Current Account and Subscription üìã

1.  To show details of the currently active subscription:

    ```powershell
    Get-AzContext
    ```

    This cmdlet shows the current account, tenant, and subscription you're connected to.

2.  To list all subscriptions associated with your account:

    ```powershell
    Get-AzSubscription
    ```

    This will list all subscriptions you have access to. The `IsDefault` property indicates the currently active one.

3.  **Setting a Default Subscription (if you have multiple)**:
    If you have multiple subscriptions, you can set a specific one as the default for your session:

    ```powershell
    Select-AzSubscription -SubscriptionName "Your Subscription Name"
    # OR
    Select-AzSubscription -SubscriptionId "Your Subscription ID"
    ```

    Replace `"Your Subscription Name"` or `"Your Subscription ID"` with the actual name or ID of the subscription you want to use.

-----

### Part 3: Basic Azure PowerShell Cmdlets

Let's try some fundamental cmdlets to manage Azure resources.

#### 3.1 Managing Resource Groups üìÅ

1.  **List all resource groups**:

    ```powershell
    Get-AzResourceGroup
    ```

    This cmdlet lists all resource groups in your active subscription.

2.  **Create a new resource group**:

    ```powershell
    New-AzResourceGroup -Name "MyPsResourceGroup" -Location "EastUS"
    ```

      * `-Name`: Specifies the name for your new resource group (e.g., `MyPsResourceGroup`).
      * `-Location`: Specifies the Azure region where the resource group's metadata will be stored (e.g., `EastUS`).

3.  **Show details of a specific resource group**:

    ```powershell
    Get-AzResourceGroup -Name "MyPsResourceGroup"
    ```

#### 3.2 Listing Resources üì¶

1.  **List all resources in your subscription**:

    ```powershell
    Get-AzResource
    ```

    This can be a very long list\!

2.  **List resources within a specific resource group**:

    ```powershell
    Get-AzResource -ResourceGroupName "MyPsResourceGroup"
    ```

    Initially, this will likely be empty.

#### 3.3 Getting Help ‚ùì

PowerShell's help system is extensive.

1.  **Get help for a specific cmdlet**:

    ```powershell
    Get-Help New-AzResourceGroup -Full
    ```

      * `-Full`: Provides detailed information, including syntax, parameters, and examples.
      * You can also use `-Examples` or `-Online` (to open web documentation).

2.  **Update Help**: It's good practice to update your help files regularly:

    ```powershell
    Update-Help -Force
    ```

#### 3.4 Cleaning Up (Optional) üßπ

If you want to remove the resource group you created:

1.  **Delete a resource group**:
    ```powershell
    Remove-AzResourceGroup -Name "MyPsResourceGroup" -Force -AsJob
    ```
      * `-Force`: Suppresses the confirmation prompt (use with extreme caution\!).
      * `-AsJob`: Runs the deletion operation as a background job, so your console prompt returns immediately.
      * **Caution**: Deleting a resource group will delete ALL resources contained within it. Ensure you want to delete everything before running this cmdlet.

This lab has provided you with the foundational knowledge to begin using Azure PowerShell. 

Its consistent syntax and object-oriented nature make it an incredibly powerful tool for managing and automating your Azure environment.